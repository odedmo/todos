var app=angular.module("myApp",["ngRoute","ngAnimate","toaster","Controllers","DataService","Directives"]);app.config(["$routeProvider",function(a){a.when("/login",{title:"Login",templateUrl:"views/login.html",controller:"LoginController"}).when("/signup",{title:"Signup",templateUrl:"views/signup.html",controller:"SignupController"}).when("/dashboard",{title:"Dashboard",templateUrl:"views/dashboard.html",controller:"DashboardController"}).when("/",{title:"Login",templateUrl:"views/login.html",controller:"LoginController",role:"0"}).otherwise({redirectTo:"/login"})}]).run(["$rootScope","$location","Data",function(a,b,c){}]),angular.module("Controllers",[]).controller("LoginController",["$scope","$location","Data",function(a,b,c){null!==localStorage.getItem("token")&&b.path("dashboard"),a.login={},a.username="",a.doLogin=function(d){a.$parent.loading=!0,c.post("login",d).then(function(d){if(a.$parent.loading=!1,c.toast(d),d.success){var e={id:d.userId,token:d.token};localStorage.setItem("user",JSON.stringify(e)),b.path("dashboard")}})}}]).controller("SignupController",["$scope","$location","Data",function(a,b,c){a.signup={userName:"",password:""},a.signUp=function(d){a.$parent.loading=!0,c.post("signUp",d).then(function(d){if(a.$parent.loading=!1,c.toast(d),d.success){var e={id:d.userId,token:d.token};localStorage.setItem("user",JSON.stringify(e)),b.path("dashboard")}})}}]).controller("DashboardController",["$scope","$location","Data",function(a,b,c){a.logout=function(){a.$parent.loading=!0,c.get("logout").then(function(d){a.$parent.loading=!1,c.toast(d),localStorage.removeItem("user"),b.path("login")})},a.selected=[],a.toggleItem=function(b){var c=!0;angular.forEach(a.selected,function(d,e){b==d&&(a.selected.splice(e,1),c=!1)}),c&&a.selected.push(b)},a.deleteTodos=function(){a.$parent.loading=!0,c.post("deleteTodos",{checked:a.selected,userId:JSON.parse(localStorage.getItem("user")).id}).then(function(b){a.$parent.loading=!1,a.todos=b.todos})},a.createTodo=function(){a.$parent.loading=!0,a.formData.userId=JSON.parse(localStorage.getItem("user")).id,c.post("todo",a.formData).then(function(b){a.$parent.loading=!1,b.success&&(a.todos=b.todos,a.formData=null)})},c.get("signedin").then(function(d){d.success?(a.username=d.username,c.post("todos",{userId:JSON.parse(localStorage.getItem("user")).id}).then(function(b){b.success&&(a.todos=b.todos)})):(localStorage.removeItem("user"),b.path("login"))})}]).controller("GeneralController",["$scope",function(a){a.loading=!1}]),angular.module("Directives",[]).directive("passwordMatch",[function(){return{require:"ngModel",scope:{originalPassword:"=passwordMatch"},link:function(a,b,c,d){d.$validators.passwordMatch=function(b){return b==a.originalPassword},a.$watch("originalPassword",function(){d.$validate()})}}}]),angular.module("DataService",[]).factory("Data",["$http","toaster",function(a,b){var c="api/",d={},e=null;return d.toast=function(a){b.pop(a.status,"",a.message,2e3,"trustedHtml")},d.get=function(b){return e=JSON.parse(localStorage.getItem("user")).token,a.get(c+b+"?token="+e).then(function(a){return a.data})},d.post=function(b,d){return e=null!==localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")).token:"",d.token=e,a.post(c+b,d).then(function(a){return a.data})},d["delete"]=function(b,d){return a["delete"](c+b).then(function(a){return a.data})},d}]);